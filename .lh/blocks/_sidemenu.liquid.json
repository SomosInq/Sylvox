{
    "sourceFile": "blocks/_sidemenu.liquid",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1753717816479,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1753717932917,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -221,9 +221,9 @@\n });\r\n </script>\r\n \r\n \r\n-<nav class=\"sidemenu\">\r\n+<nav class=\"sidemenu section_width_{{ section.settings.section_width }}\" style=\"padding: {{ section.settings.padding_top }}px {{ section.settings.padding_right }}px {{ section.settings.padding_bottom }}px {{ section.settings.padding_left }}px; margin: {{ section.settings.margin_top }}px {{ section.settings.margin_right }}px {{ section.settings.margin_bottom }}px {{ section.settings.margin_left }}px; background-color: {{ section.settings.bg_color }}; background-image: url('{{ section.settings.bg_image | image_url }}');\">\r\n     <ul class=\"menu-level-1\">\r\n         {% for link in linklists[block.settings.menu].links %}\r\n             {% assign link_active = false %}\r\n \r\n@@ -323,8 +323,32 @@\n {\r\n \t\"name\": \"Sidemenu\",\r\n \t\"class\": \"block-sidemenu\",\r\n \t\"settings\": [\r\n+    { \"type\": \"image_picker\", \"id\": \"bg_image\", \"label\": \"Background Image\" },\r\n+    { \"type\": \"color\", \"id\": \"bg_color\", \"label\": \"Background Color\", \"default\": \"#ffffff\" },\r\n+    {\r\n+      \"type\": \"select\", \"id\": \"section_width\", \"label\": \"Section Width\", \"default\": \"standard\",\r\n+      \"options\": [\r\n+        { \"value\": \"standard\", \"label\": \"50% Width\" },\r\n+        { \"value\": \"full\", \"label\": \"Full Width\" }\r\n+      ]\r\n+    },\r\n+    {\r\n+      \"type\": \"select\", \"id\": \"section_content_width\", \"label\": \"Content Width\", \"default\": \"standard\",\r\n+      \"options\": [\r\n+        { \"value\": \"standard\", \"label\": \"50% Width\" },\r\n+        { \"value\": \"full\", \"label\": \"Full Width\" }\r\n+      ]\r\n+    },\r\n+    { \"type\": \"range\", \"id\": \"padding_top\", \"label\": \"Padding Top\", \"min\": 0, \"max\": 100, \"step\": 5, \"default\": 0 },\r\n+    { \"type\": \"range\", \"id\": \"padding_bottom\", \"label\": \"Padding Bottom\", \"min\": 0, \"max\": 100, \"step\": 5, \"default\": 0 },\r\n+    { \"type\": \"range\", \"id\": \"padding_left\", \"label\": \"Padding Left\", \"min\": 0, \"max\": 100, \"step\": 5, \"default\": 0 },\r\n+    { \"type\": \"range\", \"id\": \"padding_right\", \"label\": \"Padding Right\", \"min\": 0, \"max\": 100, \"step\": 5, \"default\": 0 },\r\n+    { \"type\": \"range\", \"id\": \"margin_top\", \"label\": \"Margin Top\", \"min\": 0, \"max\": 100, \"step\": 5, \"default\": 0 },\r\n+    { \"type\": \"range\", \"id\": \"margin_bottom\", \"label\": \"Margin Bottom\", \"min\": 0, \"max\": 100, \"step\": 5, \"default\": 0 },\r\n+    { \"type\": \"range\", \"id\": \"margin_left\", \"label\": \"Margin Left\", \"min\": 0, \"max\": 100, \"step\": 5, \"default\": 0 },\r\n+    { \"type\": \"range\", \"id\": \"margin_right\", \"label\": \"Margin Right\", \"min\": 0, \"max\": 100, \"step\": 5, \"default\": 0 },\r\n \t\t{\r\n \t\t\t\"type\": \"link_list\",\r\n \t\t\t\"id\": \"menu\",\r\n \t\t\t\"label\": \"Select menu\"\r\n"
                },
                {
                    "date": 1753718119715,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -221,9 +221,9 @@\n });\r\n </script>\r\n \r\n \r\n-<nav class=\"sidemenu section_width_{{ section.settings.section_width }}\" style=\"padding: {{ section.settings.padding_top }}px {{ section.settings.padding_right }}px {{ section.settings.padding_bottom }}px {{ section.settings.padding_left }}px; margin: {{ section.settings.margin_top }}px {{ section.settings.margin_right }}px {{ section.settings.margin_bottom }}px {{ section.settings.margin_left }}px; background-color: {{ section.settings.bg_color }}; background-image: url('{{ section.settings.bg_image | image_url }}');\">\r\n+<nav class=\"sidemenu\">\r\n     <ul class=\"menu-level-1\">\r\n         {% for link in linklists[block.settings.menu].links %}\r\n             {% assign link_active = false %}\r\n \r\n@@ -323,32 +323,8 @@\n {\r\n \t\"name\": \"Sidemenu\",\r\n \t\"class\": \"block-sidemenu\",\r\n \t\"settings\": [\r\n-    { \"type\": \"image_picker\", \"id\": \"bg_image\", \"label\": \"Background Image\" },\r\n-    { \"type\": \"color\", \"id\": \"bg_color\", \"label\": \"Background Color\", \"default\": \"#ffffff\" },\r\n-    {\r\n-      \"type\": \"select\", \"id\": \"section_width\", \"label\": \"Section Width\", \"default\": \"standard\",\r\n-      \"options\": [\r\n-        { \"value\": \"standard\", \"label\": \"50% Width\" },\r\n-        { \"value\": \"full\", \"label\": \"Full Width\" }\r\n-      ]\r\n-    },\r\n-    {\r\n-      \"type\": \"select\", \"id\": \"section_content_width\", \"label\": \"Content Width\", \"default\": \"standard\",\r\n-      \"options\": [\r\n-        { \"value\": \"standard\", \"label\": \"50% Width\" },\r\n-        { \"value\": \"full\", \"label\": \"Full Width\" }\r\n-      ]\r\n-    },\r\n-    { \"type\": \"range\", \"id\": \"padding_top\", \"label\": \"Padding Top\", \"min\": 0, \"max\": 100, \"step\": 5, \"default\": 0 },\r\n-    { \"type\": \"range\", \"id\": \"padding_bottom\", \"label\": \"Padding Bottom\", \"min\": 0, \"max\": 100, \"step\": 5, \"default\": 0 },\r\n-    { \"type\": \"range\", \"id\": \"padding_left\", \"label\": \"Padding Left\", \"min\": 0, \"max\": 100, \"step\": 5, \"default\": 0 },\r\n-    { \"type\": \"range\", \"id\": \"padding_right\", \"label\": \"Padding Right\", \"min\": 0, \"max\": 100, \"step\": 5, \"default\": 0 },\r\n-    { \"type\": \"range\", \"id\": \"margin_top\", \"label\": \"Margin Top\", \"min\": 0, \"max\": 100, \"step\": 5, \"default\": 0 },\r\n-    { \"type\": \"range\", \"id\": \"margin_bottom\", \"label\": \"Margin Bottom\", \"min\": 0, \"max\": 100, \"step\": 5, \"default\": 0 },\r\n-    { \"type\": \"range\", \"id\": \"margin_left\", \"label\": \"Margin Left\", \"min\": 0, \"max\": 100, \"step\": 5, \"default\": 0 },\r\n-    { \"type\": \"range\", \"id\": \"margin_right\", \"label\": \"Margin Right\", \"min\": 0, \"max\": 100, \"step\": 5, \"default\": 0 },\r\n \t\t{\r\n \t\t\t\"type\": \"link_list\",\r\n \t\t\t\"id\": \"menu\",\r\n \t\t\t\"label\": \"Select menu\"\r\n"
                }
            ],
            "date": 1753717816479,
            "name": "Commit-0",
            "content": "\r\n\r\n<div class=\"mobile-sidemenu\">\r\n\t<div class=\"form-control\" id=\"menu-level-1\">\r\n\t\t<select>\r\n\t\t\t<option value=\"\">Select a section</option>\r\n\t\t\t{% for top in linklists[block.settings.menu].links %}\r\n\t\t\t\t<option\r\n\t\t\t\t\tvalue=\"{{ top.url }}\"\r\n\t\t\t\t\tdata-children='{% capture children %}[{% for child in top.links %}{\"title\":\"{{ child.title | escape }}\",\"url\":\"{{ child.url }}\",\"children\":[{% for grand in child.links %}{\"title\":\"{{ grand.title | escape }}\",\"url\":\"{{ grand.url }}\"}{% unless forloop.last %},{% endunless %}{% endfor %}]}{% unless forloop.last %},{% endunless %}{% endfor %}]{% endcapture %}{{ children | strip_newlines | escape }}'\r\n\t\t\t\t>\r\n\t\t\t\t\t{{ top.title }}\r\n\t\t\t\t</option>\r\n\t\t\t{% endfor %}\r\n\t\t</select>\r\n\t\t{%- render 'icon' with 'chevron-bottom', class: 'select-chevron' -%}\r\n\t</div>\r\n\r\n\t<div class=\"form-control hidden\" id=\"menu-level-2\">\r\n\t\t<select></select>\r\n\t\t{%- render 'icon' with 'chevron-bottom', class: 'select-chevron' -%}\r\n\t</div>\r\n\r\n\t<div class=\"form-control hidden\" id=\"menu-level-3\">\r\n\t\t<select></select>\r\n\t\t{%- render 'icon' with 'chevron-bottom', class: 'select-chevron' -%}\r\n\t</div>\r\n</div>\r\n\r\n\r\n\r\n<script id=\"request-path\" type=\"application/json\">\r\n\t{{ request.path | json }}\r\n</script>\r\n\r\n<script>\r\ndocument.addEventListener('DOMContentLoaded', function () {\r\n\tconst level1 = document.querySelector('#menu-level-1');\r\n\tconst level2 = document.querySelector('#menu-level-2');\r\n\tconst level3 = document.querySelector('#menu-level-3');\r\n\r\n\tconst select1 = level1.querySelector('select');\r\n\tconst select2 = level2.querySelector('select');\r\n\tconst select3 = level3.querySelector('select');\r\n\r\n\tconst currentPath = JSON.parse(document.getElementById('request-path').textContent);\r\n\r\n\tfunction reset(wrapper) {\r\n\t\tconst select = wrapper.querySelector('select');\r\n\t\tselect.innerHTML = '';\r\n\t\twrapper.classList.add('hidden');\r\n\t}\r\n\r\n\tfunction populate(wrapper, items, selectedUrl = null) {\r\n\t\treset(wrapper);\r\n\t\tif (!items || !items.length) return;\r\n\r\n\t\tconst select = wrapper.querySelector('select');\r\n\t\tselect.innerHTML = `<option value=\"\">Select an option</option>`;\r\n\t\titems.forEach(item => {\r\n\t\t\tconst opt = document.createElement('option');\r\n\t\t\topt.value = item.url;\r\n\t\t\topt.textContent = item.title;\r\n\t\t\topt.dataset.children = JSON.stringify(item.children || []);\r\n\r\n\t\t\tif (selectedUrl && item.url.includes(selectedUrl)) {\r\n\t\t\t\topt.selected = true;\r\n\t\t\t}\r\n\t\t\tselect.appendChild(opt);\r\n\t\t});\r\n\t\twrapper.classList.remove('hidden');\r\n\t}\r\n\r\n\tfunction findMatch(links, path) {\r\n\t\tfor (const top of links) {\r\n\t\t\tif (top.url.includes(path)) return { level: 1, item: top };\r\n\t\t\tfor (const child of top.children || []) {\r\n\t\t\t\tif (child.url.includes(path)) return { level: 2, parent: top, item: child };\r\n\t\t\t\tfor (const grand of child.children || []) {\r\n\t\t\t\t\tif (grand.url.includes(path)) {\r\n\t\t\t\t\t\treturn { level: 3, top: top, child: child, item: grand };\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\t// Step 1: Build data from select1 options\r\n\tconst options = [...select1.options].slice(1);\r\n\tconst links = options.map(opt => ({\r\n\t\ttitle: opt.textContent,\r\n\t\turl: opt.value,\r\n\t\tchildren: JSON.parse(opt.dataset.children || '[]')\r\n\t}));\r\n\r\n\tconst match = findMatch(links, currentPath);\r\n\r\n\t// Step 2: Pre-populate\r\n\tif (match) {\r\n\t\tif (match.level === 1) {\r\n\t\t\tpopulate(level1, links, match.item.url);\r\n\t\t}\r\n\t\tif (match.level === 2) {\r\n\t\t\tpopulate(level1, links, match.parent.url);\r\n\t\t\tpopulate(level2, match.parent.children, match.item.url);\r\n\t\t}\r\n\t\tif (match.level === 3) {\r\n\t\t\tpopulate(level1, links, match.top.url);\r\n\t\t\tpopulate(level2, match.top.children, match.child.url);\r\n\t\t\tpopulate(level3, match.child.children, match.item.url);\r\n\t\t}\r\n\t} else {\r\n\t\tpopulate(level1, links);\r\n\t}\r\n\r\n\t// Step 3: Handle change\r\n\tselect1.addEventListener('change', function () {\r\n\t\tconst selected = this.selectedOptions[0];\r\n\t\tconst children = selected.dataset.children ? JSON.parse(selected.dataset.children) : [];\r\n\r\n\t\treset(level2);\r\n\t\treset(level3);\r\n\r\n\t\tif (children.length) {\r\n\t\t\tpopulate(level2, children);\r\n\t\t} else if (this.value) {\r\n\t\t\twindow.location.href = this.value;\r\n\t\t}\r\n\t});\r\n\r\n\tselect2.addEventListener('change', function () {\r\n\t\tconst selected = this.selectedOptions[0];\r\n\t\tconst children = selected.dataset.children ? JSON.parse(selected.dataset.children) : [];\r\n\r\n\t\treset(level3);\r\n\r\n\t\tif (children.length) {\r\n\t\t\tpopulate(level3, children);\r\n\t\t} else if (this.value) {\r\n\t\t\twindow.location.href = this.value;\r\n\t\t}\r\n\t});\r\n\r\n\tselect3.addEventListener('change', function () {\r\n\t\tif (this.value) {\r\n\t\t\twindow.location.href = this.value;\r\n\t\t}\r\n\t});\r\n});\r\n</script>\r\n\r\n\r\n\r\n\r\n\r\n\r\n<script>\r\ndocument.addEventListener('DOMContentLoaded', function () {\r\n\tconst menuData = JSON.parse(document.getElementById('menu-data').textContent);\r\n\tconst level1 = document.getElementById('menu-level-1');\r\n\tconst level2 = document.getElementById('menu-level-2');\r\n\tconst level3 = document.getElementById('menu-level-3');\r\n\r\n\tfunction reset(select) {\r\n\t\tselect.innerHTML = '';\r\n\t\tselect.classList.add('hidden');\r\n\t}\r\n\r\n\tfunction populate(select, items) {\r\n\t\treset(select);\r\n\t\tif (!items || items.length === 0) return;\r\n\r\n\t\tselect.innerHTML = `<option value=\"\">Select an option</option>`;\r\n\t\titems.forEach((item, i) => {\r\n\t\t\tconst opt = document.createElement('option');\r\n\t\t\topt.value = item.url;\r\n\t\t\topt.textContent = item.title;\r\n\t\t\topt.dataset.index = i;\r\n\t\t\topt.dataset.children = JSON.stringify(item.links || []);\r\n\t\t\tselect.appendChild(opt);\r\n\t\t});\r\n\t\tselect.classList.remove('hidden');\r\n\t}\r\n\r\n\t// Populate level 1\r\n\tpopulate(level1, menuData.links);\r\n\r\n\tlevel1.addEventListener('change', function () {\r\n\t\tconst selected = this.selectedOptions[0];\r\n\t\tconst children = JSON.parse(selected.dataset.children || '[]');\r\n\r\n\t\treset(level2);\r\n\t\treset(level3);\r\n\r\n\t\tif (children.length) {\r\n\t\t\tpopulate(level2, children);\r\n\t\t} else if (this.value) {\r\n\t\t\twindow.location.href = this.value;\r\n\t\t}\r\n\t});\r\n\r\n\tlevel2.addEventListener('change', function () {\r\n\t\tconst selected = this.selectedOptions[0];\r\n\t\tconst children = JSON.parse(selected.dataset.children || '[]');\r\n\r\n\t\treset(level3);\r\n\r\n\t\tif (children.length) {\r\n\t\t\tpopulate(level3, children);\r\n\t\t} else if (this.value) {\r\n\t\t\twindow.location.href = this.value;\r\n\t\t}\r\n\t});\r\n\r\n\tlevel3.addEventListener('change', function () {\r\n\t\tif (this.value) {\r\n\t\t\twindow.location.href = this.value;\r\n\t\t}\r\n\t});\r\n});\r\n</script>\r\n\r\n\r\n<nav class=\"sidemenu\">\r\n    <ul class=\"menu-level-1\">\r\n        {% for link in linklists[block.settings.menu].links %}\r\n            {% assign link_active = false %}\r\n\r\n            {% for child_link in link.links %}\r\n                {% if child_link.url contains request.path %}\r\n                    {% assign link_active = true %}\r\n                {% endif %}\r\n                {% for grandchild_link in child_link.links %}\r\n                    {% if grandchild_link.url contains request.path %}\r\n                        {% assign link_active = true %}\r\n                    {% endif %}\r\n                {% endfor %}\r\n            {% endfor %}\r\n\r\n            <li class=\"{% if link.links != blank %}has-children{% endif %} {% if link_active %}is-active{% endif %} {% if link.url contains request.path %}is-current{% endif %}\">\r\n                <a href=\"{{ link.url }}\">{{ link.title }}</a>\r\n\r\n                {% if link.links != blank %}\r\n                    <ul class=\"menu-level-2\">\r\n                        {% for child_link in link.links %}\r\n                            {% assign child_active = false %}\r\n                            {% if child_link.url contains request.path %}\r\n                                {% assign child_active = true %}\r\n                            {% endif %}\r\n                            {% for grandchild_link in child_link.links %}\r\n                                {% if grandchild_link.url contains request.path %}\r\n                                    {% assign child_active = true %}\r\n                                {% endif %}\r\n                            {% endfor %}\r\n\r\n                            <li class=\"{% if child_link.links != blank %}has-children{% endif %} {% if child_active %}is-active{% endif %}\">\r\n                                <a href=\"{{ child_link.url }}\" class=\"{% if child_link.url contains request.path %}is-current{% endif %}\">\r\n                                    {%- assign child_url_parts = child_link.url | split: '/' -%}\r\n                                    {%- if child_url_parts[1] == 'collections' -%}\r\n                                        {%- assign child_handle = child_url_parts[2] -%}\r\n                                        {%- assign child_collection = collections[child_handle] -%}\r\n                                        {%- if child_collection.image != blank -%}\r\n                                            <img src=\"{{ child_collection.image | image_url: width: 60 }}\" alt=\"{{ child_collection.title }}\" class=\"menu-collection-icon\">\r\n                                        {%- endif -%}\r\n                                    {%- endif -%}\r\n                                    {{ child_link.title }}\r\n\t\t\t\t\t\t\t\t\t{% if child_link.links != blank %} {% render 'icon-arrow-next' %}{% endif %}\r\n                                </a>\r\n\r\n                                {% if child_link.links != blank %}\r\n                                    <ul class=\"menu-level-3\">\r\n                                        {% for grandchild_link in child_link.links %}\r\n                                            <li class=\"{% if grandchild_link.url contains request.path %}is-current{% endif %}\">\r\n                                                <a href=\"{{ grandchild_link.url }}\">\r\n                                                    {{ grandchild_link.title }}\r\n                                                </a>\r\n                                            </li>\r\n                                        {% endfor %}\r\n                                    </ul>\r\n                                {% endif %}\r\n                            </li>\r\n                        {% endfor %}\r\n                    </ul>\r\n                {% endif %}\r\n            </li>\r\n        {% endfor %}\r\n    </ul>\r\n</nav>\r\n\r\n\r\n\r\n<script>\r\ndocument.addEventListener('DOMContentLoaded', function() {\r\n\tdocument.querySelectorAll('.sidemenu a').forEach(function(link) {\r\n\t\tlink.addEventListener('click', function(e) {\r\n\t\t\tconst parentItem = this.parentElement;\r\n\t\t\tconst isTopLevel = parentItem.parentElement.classList.contains('menu-level-1');\r\n\r\n\t\t\t// Check if this item has children\r\n\t\t\tif (parentItem.classList.contains('has-children')) {\r\n\t\t\t\te.preventDefault(); // prevent link navigation\r\n\r\n\t\t\t\tif (isTopLevel) {\r\n\t\t\t\t\t// Remove is-active from all other top-level items\r\n\t\t\t\t\tdocument.querySelectorAll('.menu-level-1 > li.is-active').forEach(function(item) {\r\n\t\t\t\t\t\tif (item !== parentItem) {\r\n\t\t\t\t\t\t\titem.classList.remove('is-active');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Toggle is-active on clicked item\r\n\t\t\t\tparentItem.classList.toggle('is-active');\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n});\r\n</script>\r\n\r\n\r\n{% schema %}\r\n{\r\n\t\"name\": \"Sidemenu\",\r\n\t\"class\": \"block-sidemenu\",\r\n\t\"settings\": [\r\n\t\t{\r\n\t\t\t\"type\": \"link_list\",\r\n\t\t\t\"id\": \"menu\",\r\n\t\t\t\"label\": \"Select menu\"\r\n\t\t}\r\n\t],\r\n\t\"presets\": [\r\n\t\t{\r\n\t\t\t\"name\": \"Sidemenu\"\r\n\t\t}\r\n\t]\r\n}\r\n{% endschema %}\r\n"
        }
    ]
}