{%- unless section.settings.full_width -%}
  {%- render 'section-spacing-collapsing' -%}
{%- endunless -%}

<style>
  #shopify-section-{{ section.id }} {
    {%- if section.settings.full_width -%}
      --section-outer-spacing-block: 0;
    {%- endif -%}

    --content-over-media-overlay: {{ section.settings.overlay_color.rgb }} / {{ section.settings.overlay_opacity | divided_by: 100.0 }};

    {%- if section.settings.allow_transparent_header -%}
      margin-block-start: calc(-1 * var(--header-height) * var(--section-is-first));
    {%- endif -%}
  }
</style>

<div {% render 'section-properties' %} {% if section.settings.allow_transparent_header %}allow-transparent-header{% endif %}>
  {%- capture class -%}content-over-media content-over-media--{{ section.settings.image_size }} {% if section.settings.full_width %}full-bleed{% else %}shadow-block rounded-lg{% endif %}{%- endcapture -%}

  <image-banner reveal-on-scroll="true" {% if section.settings.enable_parallax %}parallax="0.3"{% endif %} {% render 'surface', class: class, text_color: section.settings.text_color %}>
    {%- if section.settings.image != blank -%}
      {%- capture sizes -%}{% if section.settings.full_width %}100vw{% else %}(max-width: 740px) calc(100vw - 40px), (max-width: 999px) calc(100vw - 64px), min({{ settings.page_width }}px, 100vw - 96px){% endif %}{%- endcapture -%}
      {%- capture fetch_priority -%}{% if section.index == 1 %}high{% else %}low{% endif %}{%- endcapture -%}

      <picture>
        {%- if section.settings.mobile_image != blank -%}
          <source
            media="(max-width: 699px)"
            srcset="{{ section.settings.mobile_image | image_url: width: 400 }} 400w, {{ section.settings.mobile_image | image_url: width: 600 }} 600w, {{ section.settings.mobile_image | image_url: width: 800 }} 800w, {{ section.settings.mobile_image | image_url: width: 1000 }} 1000w, {{ section.settings.mobile_image | image_url: width: 1200 }} 1200w"
            width="{{ section.settings.mobile_image.width }}"
            height="{{ section.settings.mobile_image.height }}"
          >
        {%- endif -%}

        {{- section.settings.image | image_url: width: section.settings.image.width | image_tag: sizes: sizes, fetchpriority: fetch_priority, widths: '200,300,400,500,600,700,800,900,1000,1200,1400,1600,1800,2000,2200,2400,2600,2800,3000,3200' -}}
      </picture>
    {%- else -%}
      {{ 'lifestyle-1' | placeholder_svg_tag: 'placeholder' | replace: '<svg', '<svg preserveAspectRatio="xMinYMin slice"' }}
    {%- endif -%}

    {%- if section.blocks.size > 0 -%}
      <div class="grid w-full h-full">
        <div class="grid w-full h-full">
          <div class="{{ section.settings.mobile_text_position }} {{ section.settings.desktop_text_position }}" style="color: {{ section.settings.text_color }};">
            <div class="prose">
              {%- for block in section.blocks -%}
                {%- case block.type -%}
                  {%- when 'subheading' -%}
                    {%- if block.settings.text != blank -%}
                      <p class="bold" {{ block.shopify_attributes }}>{{ block.settings.text | escape }}</p>
                    {%- endif -%}

                  {%- when 'heading' -%}
                    {%- if block.settings.text != blank -%}
                      <p class="{{ block.settings.heading_tag }}" {% if settings.heading_apparition != 'none' %}reveal-on-scroll="true"{% endif %} {{ block.shopify_attributes }}>
                        {%- render 'styled-text', content: block.settings.text, apparition_effect: true -%}
                      </p>
                    {%- endif -%}

                  {%- when 'richtext' -%}
                    {%- if block.settings.content != blank -%}
                      <div {{ block.shopify_attributes }}>
                        {{- block.settings.content -}}
                      </div>
                    {%- endif -%}

                  {%- when 'liquid' -%}
                    {%- if block.settings.liquid != blank -%}
                      <div {{ block.shopify_attributes }}>
                        {{- block.settings.liquid -}}
                      </div>
                    {%- endif -%}

                  {%- when 'button' -%}
                    {%- if block.settings.text != blank -%}
                      {% render 'button', content: block.settings.text, href: block.settings.url, size: block.settings.size, style: block.settings.style, background: block.settings.background, text_color: block.settings.text_color, block: block %}
                    {%- endif -%}

                  {%- when 'image' -%}
                    {%- if block.settings.image != blank -%}
                      <img src="{{ block.settings.image | image_url: '800x' }}" alt="{{ block.settings.image.alt | escape }}" {{ block.shopify_attributes }} loading="lazy" width="{{ block.settings.width }}" height="auto">
                    {%- endif -%}
                {%- endcase -%}
              {%- endfor -%}
            </div>

            {% for block in section.blocks %}
              {% case block.type %}
                {% when 'link' %}
                  {%- if block.settings.link_text != blank -%}
                    <a href="{{ block.settings.link_url }}" class="text-with-icon group">
                      <span class="reversed-link">{{- block.settings.link_text | escape -}}</span>
                      <span class="circle-chevron group-hover:colors">{%- render 'icon' with 'chevron-right-small', direction_aware: true -%}</span>
                    </a>
                  {%- endif -%}
              {% endcase %}
            {% endfor %}
          </div>
        </div>
      </div>
    {%- endif -%}
  </image-banner>
</div>
