{% schema %}
{
  "name": "Image/Text Flex Blocks",
  "settings": [
    {
      "type": "select",
      "id": "alignment",
      "label": "Content Alignment",
      "default": "center",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ]
    }
  ],
  "blocks": [
    {
      "type": "image",
      "name": "Image",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        }
      ]
    },
    {
      "type": "title",
      "name": "Title",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Title Text",
          "default": "Your Section Title"
        }
      ]
    },
    {
      "type": "text",
      "name": "Text",
      "settings": [
        {
          "type": "textarea",
          "id": "text",
          "label": "Paragraph Text",
          "default": "Some supporting content that explains your product or story."
        }
      ]
    },
    {
      "type": "button",
      "name": "Button",
      "settings": [
        {
          "type": "text",
          "id": "button_text",
          "label": "Button Text",
          "default": "Learn More"
        },
        {
          "type": "url",
          "id": "button_link",
          "label": "Button Link"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Image/Text Flex Blocks",
      "category": "Custom",
      "blocks": [
        { "type": "image" },
        { "type": "title" },
        { "type": "text" },
        { "type": "button" }
      ]
    }
  ]
}
{% endschema %}

<div class="image-text-blocks-section px-4 md:px-8 py-6" style="text-align: {{ settings.alignment }};">
  {% for block in section.blocks %}
    {% case block.type %}
      {% when 'image' %}
        {% if block.settings.image %}
          <img
            src="{{ block.settings.image | image_url: width: 1200 }}"
            alt="Section image"
            class="w-full mb-4"
            loading="lazy"
          />
        {% endif %}

      {% when 'title' %}
        <h2 class="text-2xl md:text-4xl font-bold mb-2">{{ block.settings.title }}</h2>

      {% when 'text' %}
        <p class="mb-4">{{ block.settings.text }}</p>

      {% when 'button' %}
        {% if block.settings.button_text and block.settings.button_link %}
          <div>
            <a href="{{ block.settings.button_link }}"
               class="inline-block bg-black text-white py-2 px-4 rounded hover:bg-gray-800"
               style="{% if settings.alignment == 'center' %} display: block; margin-left: auto; margin-right: auto; {% elsif settings.alignment == 'right' %} display: block; margin-left: auto; {% endif %}">
              {{ block.settings.button_text }}
            </a>
          </div>
        {% endif %}
    {% endcase %}
  {% endfor %}
</div>
