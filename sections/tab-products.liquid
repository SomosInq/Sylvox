{{ 'section-tab-products.css' | asset_url | stylesheet_tag }}

<style>
  {%- assign section_background = section.settings.background | default: settings.background -%}
  {%- assign card_background = section.settings.product_card_background | default: settings.product_card_background -%}
  {%- assign card_blends = false -%}

  {%- unless section_background != 'rgba(0,0,0,0)' and card_background != 'rgba(0,0,0,0)' and section_background != card_background -%}
    {%- assign card_blends = true -%}
  {%- endunless -%}

  #shopify-section-{{ section.id }} .product-list {
    --product-list-gap: {% if section.settings.stack_products and section.settings.products_per_row_mobile == '2' %}{% if card_blends %}var(--product-list-row-gap){% endif %} var(--spacing-2){% else %}var(--product-list-row-gap) var(--product-list-column-gap){% endif %};
    --product-list-items-per-row: {{ section.settings.products_per_row_mobile | times: 1 }};
    --product-list-carousel-item-width: 74vw;
    --product-list-grid: {% if section.settings.stack_products %}auto / repeat(var(--product-list-items-per-row), minmax(0, 1fr)){% else %}auto / auto-flow var(--product-list-carousel-item-width){% endif %};
  }

  @media screen and (min-width: 700px) {
    #shopify-section-{{ section.id }} .product-list {
      --product-list-gap: var(--product-list-row-gap) var(--product-list-column-gap);
      --product-list-items-per-row: 2;
      --product-list-carousel-item-width: 36vw;
    }
  }

  @media screen and (min-width: 1000px) {
    #shopify-section-{{ section.id }} .product-list {
      --product-list-items-per-row: {{ section.settings.products_per_row_desktop }};
      --product-list-carousel-item-width: calc(var(--container-inner-width) / {{ section.settings.products_per_row_desktop }} - (var(--product-list-column-gap) / {{ section.settings.products_per_row_desktop }} * {{ section.settings.products_per_row_desktop | minus: 1 }}));
    }
  }

  .tab-product-content__info {
    display: grid;
    place-items: var(--vertical-align, center) var(--horizontal-align, center);
    text-align: var(--text-align, center);
  }

  .tab-product-content__info.place-left {
    --horizontal-align: start;
    --text-align: left;
  }

  .tab-product-content__info.place-center {
    --horizontal-align: center;
    --text-align: center;
  }

  .tab-product-content__info.place-right {
    --horizontal-align: end;
    --text-align: right;
  }

  .tab-product-content__info.align-top {
    --vertical-align: start;
  }

  .tab-product-content__info.align-middle {
    --vertical-align: center;
  }

  .tab-product-content__info.align-bottom {
    --vertical-align: end;
  }

  .product-filter-buttons {
    display: flex;
    gap: 0.5rem;
    margin-top: 0.75rem;
  }

  .filter-btn {
    background: white;
    border: 1px solid #ccc;
    padding: 0.3rem 0.6rem;
    font-size: 0.875rem;
    cursor: pointer;
    border-radius: 0.375rem;
  }

  .full-width-section {
    width: 100vw;
    margin-left: calc(-1 * var(--container-padding, 20px));
    margin-right: calc(-1 * var(--container-padding, 20px));
  }

  .contained-section {
    max-width: var(--container-inner-width, 1280px);
    margin: 0 auto;
  }
</style>

<!-- Inside the image-banner section of your template, insert this directly -->
{% if block.settings.overlay_image %}
  <div style="position:absolute; top:0.5rem; right:0.5rem; z-index:2;">
    <img src="{{ block.settings.overlay_image | image_url }}" alt="Overlay" style="max-width:100px;">
  </div>
{% endif %}

<!-- Inside tab-product-content__info -->
<div class="tab-product-content__info place-{{ block.settings.text_align }} align-{{ block.settings.text_vertical }}"
     style="--tab-text-color: {{ block.settings.text_color }}; --tab-content-max-width: {{ block.settings.content_max_width }}px;">
  <div class="tab-product-content__info-title">
    <h3 class="{{ block.settings.heading_tag }}">{{ block.settings.title }}</h3>
    {% if block.settings.inline_title != blank %}
      <span>{{ block.settings.inline_title }}</span>
    {% endif %}
    <div class="product-filter-buttons">
      <button class="filter-btn" data-filter="all">All</button>
      <button class="filter-btn" data-filter="full-sun">Full Sun</button>
      <button class="filter-btn" data-filter="partial-sun">Partial Sun</button>
    </div>
  </div>
  <div class="tab-product-content__info-dec">
    {{ block.settings.description }}
  </div>
</div>

{% schema %}
{
  "blocks": [
    {
      "type": "tab",
      "name": "Tab",
      "settings": [
        {
          "type": "text",
          "id": "tab_label",
          "label": "Tab Label"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Heading"
        },
        {
          "type": "select",
          "id": "heading_tag",
          "label": "Heading size",
          "options": [
            { "value": "h2", "label": "Large" },
            { "value": "h3", "label": "Medium" }
          ],
          "default": "h2"
        },
        {
          "type": "text",
          "id": "inline_title",
          "label": "Product inline title",
          "default": "Series"
        },
        {
          "type": "richtext",
          "id": "description",
          "label": "Description"
        },
        {
          "type": "range",
          "id": "content_max_width",
          "label": "Content maximum width",
          "min": 400,
          "max": 1200,
          "step": 20,
          "unit": "px",
          "default": 780
        },
        {
          "type": "color",
          "id": "text_color",
          "label": "Text color",
          "default": "#000000"
        },
        {
          "type": "select",
          "id": "text_align",
          "label": "Horizontal alignment",
          "options": [
            { "value": "left", "label": "Left" },
            { "value": "center", "label": "Center" },
            { "value": "right", "label": "Right" }
          ],
          "default": "center"
        },
        {
          "type": "select",
          "id": "text_vertical",
          "label": "Vertical alignment",
          "options": [
            { "value": "top", "label": "Top" },
            { "value": "middle", "label": "Middle" },
            { "value": "bottom", "label": "Bottom" }
          ],
          "default": "middle"
        },
        {
          "type": "image_picker",
          "id": "overlay_image",
          "label": "Top Right Overlay Image"
        }
      ]
    }
  ]
}
{% endschema %}
